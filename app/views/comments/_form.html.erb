<% if type == 'Comment' %>
  <% path_type = object.replies.build %>
  <% parent_id = object.id %>
<% else %>
  <% path_type = object.comments.build %>
  <% parent_id = nil %>
<% end %>

<%= form_with(model: [ object, path_type ], local: true) do |form| %>
  <p>
    <%= form.label :text %><br>
    <%= form.text_area :text %>
    <%= form.hidden_field 'commentable_id', value: object.id %>
    <%= form.hidden_field 'commentable_type', value: type %>
    <%= form.hidden_field 'parent_id', value: parent_id %>
  </p>
  <p>
    <%= form.submit %>
  </p>
<% end %>
